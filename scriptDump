# Import the AzureAD module
Import-Module AzureAD

# Connect to your Azure AD tenant (you will be prompted for credentials)
Connect-AzureAD

# Get all app registrations in Azure AD
$allAppRegistrations = Get-AzureADApplication

# Loop through each app registration and retrieve the expiry date
foreach ($appRegistration in $allAppRegistrations) {
    $appName = $appRegistration.DisplayName
    $appId = $appRegistration.AppId
    $expiryDate = $appRegistration.EndDate

    # Output the information
    Write-Host "App Name: $appName"
    Write-Host "App ID: $appId"
    Write-Host "Expiry Date: $expiryDate"
    Write-Host "------------------------"
}

# Disconnect from Azure AD (optional)
Disconnect-AzureAD
