# Define your parameters
$ouPath = "OU=YourOU,DC=example,DC=com"  # Replace with the actual OU path
$csvFile = "C:\Path\To\GroupNames.csv"  # Replace with the path to your CSV file

# Check if the Active Directory module is loaded, and load it if not
if (-not (Get-Module -Name ActiveDirectory)) {
    Import-Module ActiveDirectory
}

# Read group names and SAM account names from the CSV file and create the groups
$groupData = Import-Csv -Path $csvFile

foreach ($entry in $groupData) {
    $groupName = $entry.GroupName
    $samAccountName = $entry.SamAccountName
    New-ADGroup -Name $groupName -GroupScope Universal -Path $ouPath -GroupCategory Security -SamAccountName $samAccountName

    # Optional: Add members to the group if needed
    # Add-ADGroupMember -Identity $groupName -Members "User1", "User2", ...

    Write-Host "Security group '$groupName' with Universal scope and SAM account name '$samAccountName' created in OU '$ouPath'."
}
