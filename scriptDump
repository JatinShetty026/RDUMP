# Define the extensionAttribute value you want to set
$extensionAttributeNewValue = "NewValueHere"

# Specify the group name (change to the actual group name)
$groupName = "YourGroupName"

# Import the Active Directory module if not already loaded
if (-not (Get-Module -Name ActiveDirectory)) {
    Import-Module ActiveDirectory
}

# Get the group members
$groupMembers = Get-ADGroupMember -Identity $groupName

# Loop through the group members and update the extensionAttribute
foreach ($member in $groupMembers) {
    if ($member.objectClass -eq "user") {
        # Check if the member is a user object
        $user = Get-ADUser -Identity $member
        # Update the extensionAttribute (change -replace to -add if you want to append)
        Set-ADUser -Identity $user -Replace @{extensionAttribute1 = $extensionAttributeNewValue}
        Write-Host "Updated extensionAttribute for $($user.SamAccountName)"
    }
    else {
        Write-Host "$($member.Name) is not a user object and will not be updated."
    }
}
