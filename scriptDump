# Define your parameters
$ouPath = "OU=YourOU,DC=example,DC=com"  # Replace with the actual OU path
$groupNamesFile = "C:\Path\To\GroupNames.txt"  # Replace with the path to your text file

# Check if the Active Directory module is loaded, and load it if not
if (-not (Get-Module -Name ActiveDirectory)) {
    Import-Module ActiveDirectory
}

# Read the group names from the text file and create the groups
$groupNames = Get-Content $groupNamesFile

foreach ($groupName in $groupNames) {
    $samAccountName = $groupName  # You can customize this if needed
    New-ADGroup -Name $groupName -GroupScope Universal -Path $ouPath -GroupCategory Security -SamAccountName $samAccountName

    # Optional: Add members to the group if needed
    # Add-ADGroupMember -Identity $groupName -Members "User1", "User2", ...

    Write-Host "Security group '$groupName' with Universal scope and SAM account name '$samAccountName' created in OU '$ouPath'."
}
